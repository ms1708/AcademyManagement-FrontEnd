<!-- Onboarding Step 3 Page -->
<div class="onboarding-page">
  <div class="main-container">
    <!-- Left Section - Context -->
    <div class="context-section">
      <div class="context-overlay"></div>
      <div class="context-content">
        <!-- Icon -->
        <div class="context-icon">
          <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="20" cy="20" r="20" fill="currentColor"/>
            <path d="M20 8C16.6863 8 14 10.6863 14 14C14 17.3137 16.6863 20 20 20C23.3137 20 26 17.3137 26 14C26 10.6863 23.3137 8 20 8Z" fill="white"/>
            <path d="M12 24C12 21.7909 13.7909 20 16 20H24C26.2091 20 28 21.7909 28 24V26H12V24Z" fill="white"/>
            <path d="M32 16C32 13.7909 33.7909 12 36 12V28C33.7909 28 32 26.2091 32 24V16Z" fill="white"/>
          </svg>
        </div>
        
        <!-- Heading -->
        <h1 class="context-title">Next of Kin</h1>
        
        <!-- Description -->
        <p class="context-description">
          Provide emergency contact information. This ensures we can reach someone important to you if needed and gives you peace of mind during your studies.
        </p>

        <!-- Progress Bar -->
        <div class="progress-container">
          <div class="progress-info">
            <span class="progress-text">Step {{ getCurrentStep() }} of {{ getTotalSteps() }}</span>
            <span class="progress-percentage">{{ getProgressPercentage() }}%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="getProgressPercentage()"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Section - Form -->
    <div class="form-section">
      <div class="form-container">
        <!-- Logo -->
        <img class="academy-logo" src="https://api.builder.io/api/v1/image/assets/TEMP/d765edc4a278dc4383d842745293ea933870fd0c?width=352" alt="App Logo" />

        <!-- Form Title -->
        <h2 class="form-title">Next of Kin Particulars</h2>

        <!-- Form -->
        <form class="next-of-kin-form" [formGroup]="nextOfKinForm" (ngSubmit)="onSubmit()">
          <!-- Title Field -->
          <div class="form-field">
            <label class="field-label" for="title">Title *</label>
            <select
              id="title"
              class="field-select"
              formControlName="title">
              <option value="" disabled>Select Title</option>
              <option *ngFor="let title of titles" [value]="title">{{ title }}</option>
            </select>
            <span *ngIf="isFieldInvalid('title')" class="error-message">{{ getFieldError('title') }}</span>
          </div>

          <!-- Full Name and Surname Row -->
          <div class="form-row">
            <!-- Full Name Field -->
            <div class="form-field form-field-half">
              <label class="field-label" for="fullName">Full Name *</label>
              <input
                id="fullName"
                type="text"
                class="field-input"
                formControlName="fullName"
                placeholder="Full Name" />
              <span *ngIf="isFieldInvalid('fullName')" class="error-message">{{ getFieldError('fullName') }}</span>
            </div>

            <!-- Surname Field -->
            <div class="form-field form-field-half">
              <label class="field-label" for="surname">Surname *</label>
              <input
                id="surname"
                type="text"
                class="field-input"
                formControlName="surname"
                placeholder="Surname" />
              <span *ngIf="isFieldInvalid('surname')" class="error-message">{{ getFieldError('surname') }}</span>
            </div>
          </div>

          <!-- Relationship Field -->
          <div class="form-field">
            <label class="field-label" for="relationship">Relationship *</label>
            <select
              id="relationship"
              class="field-select"
              formControlName="relationship">
              <option value="" disabled>Select Relationship</option>
              <option *ngFor="let relationship of relationships" [value]="relationship">{{ relationship }}</option>
            </select>
            <span *ngIf="isFieldInvalid('relationship')" class="error-message">{{ getFieldError('relationship') }}</span>
          </div>

          <!-- Next of Kin Contact Number Field -->
          <div class="form-field">
            <label class="field-label" for="contactNumber">Next of Kin Contact Number *</label>
            <div class="phone-input-container">
              <div class="country-code-select">
                <div class="flag-container">
                  <span class="country-flag">ðŸ‡¿ðŸ‡¦</span>
                </div>
                <div class="country-code">
                  <span class="code-text">+27</span>
                </div>
                <svg class="dropdown-icon" width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <input
                id="contactNumber"
                type="tel"
                class="field-input"
                formControlName="contactNumber"
                placeholder="Contact Number" />
            </div>
            <span *ngIf="isFieldInvalid('contactNumber')" class="error-message">{{ getFieldError('contactNumber') }}</span>
          </div>

          <!-- Next of Kin Email Address Field -->
          <div class="form-field">
            <label class="field-label" for="emailAddress">Next of Kin Email Address *</label>
            <input
              id="emailAddress"
              type="email"
              class="field-input"
              formControlName="emailAddress"
              placeholder="Email Address" />
            <span *ngIf="isFieldInvalid('emailAddress')" class="error-message">{{ getFieldError('emailAddress') }}</span>
          </div>

          <!-- Residential Address Field -->
          <div class="form-field">
            <label class="field-label" for="residentialAddress">Residential Address *</label>
            <textarea
              id="residentialAddress"
              class="field-textarea"
              formControlName="residentialAddress"
              placeholder="Full residential address"
              rows="4"></textarea>
            <span *ngIf="isFieldInvalid('residentialAddress')" class="error-message">{{ getFieldError('residentialAddress') }}</span>
          </div>

          <!-- Navigation Buttons -->
          <div class="button-row">
            <!-- Back Button -->
            <button
              type="button"
              class="back-button"
              (click)="onBack()"
              [disabled]="isLoading">
              Back
            </button>

            <!-- Complete Onboarding Button -->
            <button
              type="submit"
              class="complete-button"
              [disabled]="!isFormValid() || isLoading">
              <span *ngIf="!isLoading">Complete Onboarding</span>
              <span *ngIf="isLoading">Processing...</span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

